# SIEMonitor

A lightweight Security Information and Event Management (SIEM) platform built in C++ with a Qt6 GUI, designed for real-time log collection, processing, and security monitoring.

## ğŸ—ï¸ Architecture

SIEMonitor follows a client-server architecture with specialized components for comprehensive security monitoring:

### Server Component
- **Syslog Server**: Receives and processes syslog messages on port 514
- **Client Server**: Handles GUI client connections and data requests
- **Database Layer**: SQLite3-based log storage with multi-threaded writers
- **Command Handler**: Processes client requests for log data and analytics

### Client Component
- **Qt6 GUI Application**: Modern interface with multiple windows (login, connection, SIEM dashboard)
- **Real-time Updates**: Live log monitoring with background worker threads
- **Log Analysis**: Advanced log parsing and filtering capabilities
- **Network Communication**: TCP-based communication with the server

## ğŸ“ Full Project Structure

```
SIEMonitor/
â”œâ”€â”€ server/                              # Server-side SIEM engine
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.cpp                    # Server entry point
â”‚   â”‚   â”œâ”€â”€ network/
â”‚   â”‚   â”‚   â”œâ”€â”€ ServerSyslog.h          # Syslog server implementation
â”‚   â”‚   â”‚   â”œâ”€â”€ ServerClient.h          # Client connection handler
â”‚   â”‚   â”‚   â”œâ”€â”€ syslog_connections/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SyslogListener.h    # Syslog message listener
â”‚   â”‚   â”‚   â””â”€â”€ clients_connections/
â”‚   â”‚   â”‚       â””â”€â”€ ClientListener.h    # GUI client listener
â”‚   â”‚   â”œâ”€â”€ command_handler/
â”‚   â”‚   â”‚   â””â”€â”€ commands/
â”‚   â”‚   â”‚       â””â”€â”€ LogsData.hpp        # Log data query commands
â”‚   â”‚   â”œâ”€â”€ log_parser/
â”‚   â”‚   â”‚   â””â”€â”€ LogDatabaseWriter.h     # Database writer with threading
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â”œâ”€â”€ ThreadSafeQueue.h       # Thread-safe queue implementation
â”‚   â”‚       â”œâ”€â”€ ProtocolHandler.h       # Network protocol handling
â”‚   â”‚       â””â”€â”€ DBComandExecutor.h      # Database command execution
â”‚   â”œâ”€â”€ makefile                        # Server build configuration
â”‚   â””â”€â”€ target/                         # Build output directory
â”œâ”€â”€ client/                             # Qt6 GUI client application
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.cpp                    # Client entry point
â”‚   â”‚   â”œâ”€â”€ frontend/
â”‚   â”‚   â”‚   â”œâ”€â”€ gui.h                   # Main GUI controller
â”‚   â”‚   â”‚   â”œâ”€â”€ gui.cpp                 # GUI implementation
â”‚   â”‚   â”‚   â””â”€â”€ window/
â”‚   â”‚   â”‚       â”œâ”€â”€ home_screen        
â”‚   â”‚   â”‚       â”œâ”€â”€ incidents_screen
â”‚   â”‚   â”‚       â”œâ”€â”€ siem.h              # Main SIEM dashboard
â”‚   â”‚   â”‚       â”œâ”€â”€ login.hpp           # Login window
â”‚   â”‚   â”‚       â”œâ”€â”€ siem.h              # Main SIEM dashboard
â”‚   â”‚   â”‚       â””â”€â”€ ip_connect.hpp      # Server connection window
â”‚   â”‚   â””â”€â”€ backend/
â”‚   â”‚       â”œâ”€â”€ ServerConnection.h      # Server communication layer
â”‚   â”‚       â”œâ”€â”€ UpdateWorker.h          # Background update worker
â”‚   â”‚       â”œâ”€â”€ SplitLogs.hpp           # Log parsing utilities
â”‚   â”‚       â”œâ”€â”€ SplitLogs.cpp           # Log parsing implementation
â”‚   â”‚       â””â”€â”€ Utils.hpp               # Utility functions
â”‚   â””â”€â”€ makefile                        # Client build configuration
â”œâ”€â”€ extern                              # External dependencies setup
â”œâ”€â”€ LICENSE                             # GPL-3.0 License
â”œâ”€â”€ .gitignore                         # Git ignore rules
```

## âœ¨ Key Features

### Real-time Log Processing
- **Syslog Protocol Support**: Standard RFC3164 syslog message reception
- **Multi-threaded Processing**: 4 worker threads for concurrent log writing
- **Thread-safe Queue**: Efficient message queuing between components
- **SQLite3 Storage**: Persistent log storage with optimized queries

### Advanced Log Analysis
- **Severity-based Filtering**: Filter logs by severity levels
- **Host and Source Tracking**: Monitor specific hosts and log sources
- **Time-range Queries**: Historical log analysis with date/time filtering
- **Search Capabilities**: Full-text search across log messages
- **Resolution Tracking**: Mark and track resolved security incidents

### Modern GUI Interface
- **Multi-window Design**: Separate windows for connection, login, and monitoring
- **Real-time Updates**: Live log streaming with automatic refresh
- **Stacked Widget Layout**: Smooth transitions between different views
- **Responsive Design**: Maximized dashboard for comprehensive monitoring

### Network Architecture
- **TCP Communication**: Reliable client-server communication
- **Protocol Handling**: Custom protocol for efficient data exchange
- **Background Processing**: Non-blocking UI with worker threads

## ğŸ”§ Prerequisites

### Server Dependencies
```bash
# Ubuntu/Debian
sudo apt install sqlite3 libsqlite3-dev

# Clone bcrypt library
git clone https://github.com/rg3/bcrypt
```

### Client Dependencies
```bash
# Ubuntu/Debian
sudo apt install qt6-base-dev

# Fedora/RHEL
sudo dnf install qt6-qtbase-devel
```

### Build Requirements
- **C++20 Compiler**: GCC with C++20 support
- **Make**: Build system
- **SQLite3**: Database engine
- **Qt6**: GUI framework
- **bcrypt**: Password hashing library

## ğŸš€ Installation & Setup

### 1. Clone Repository
```bash
git clone https://github.com/punctIT/SIEMonitor.git
cd SIEMonitor
```

### 2. Install Dependencies
```bash
# Follow extern file instructions
cat extern
```

### 3. Build Server
```bash
cd server
make
```

### 4. Build Client
```bash
cd ../client
make
```

## ğŸ“– Usage

### Starting the Server
```bash
cd server
./target/program
```
The server will:
- Start syslog listener on port 514
- Initialize 4 database writer threads
- Start client connection server
- Begin processing incoming logs

### Launching the Client
```bash
cd client
./target/program
```
The client provides:
1. **Server Connection Window**: Configure server IP and port
2. **Login Window**: User authentication
3. **SIEM Dashboard**: Real-time monitoring and log analysis

### Log Data Queries
The system supports various log queries:
- Get logs by time range
- Filter by severity, host, source
- Search log messages
- Track resolved incidents
- Generate statistics and reports

## ğŸ”’ Security Features

- **Bcrypt Password Hashing**: Secure user authentication
- **SQLite3 Injection Protection**: Parameterized queries
- **Thread-safe Operations**: Concurrent access protection
- **Network Protocol Security**: Custom secure communication protocol

## ğŸ“Š Performance

- **Multi-threaded Processing**: Concurrent log writing with 4 worker threads
- **Efficient Queuing**: Thread-safe queue for high-throughput processing
- **Optimized Database**: SQLite3 with indexed queries for fast retrieval
- **Lightweight Design**: Minimal resource footprint

## ğŸ“ License

This project is licensed under the GNU General Public License v3.0 - see the [LICENSE](LICENSE) file for details.

---

**Built with C++20, Qt6, and SQLite3 for enterprise-grade security monitoring**