# SIEMonitor


A lightweight Security Information and Event Management (SIEM) platform built in C++ with a Qt6 GUI, designed for real-time log collection, processing, and security monitoring, created for educational purposes.

## ğŸ—ï¸ Architecture

SIEMonitor follows a client-server architecture with specialized components for comprehensive security monitoring:

### Server Component
- **Syslog Server**: Receives and processes syslog messages on port 1514
- **Client Server**: Handles GUI client connections and data requests on port 12345
- **Database Layer**: SQLite3-based log storage with multi-threaded writers
- **Command Handler**: Processes client requests for log data and analytics

### Client Component
- **Qt6 GUI Application**: Modern interface with multiple windows (login, connection, SIEM dashboard)
- **Real-time Updates**: Live log monitoring with background worker threads
- **Log Analysis**: Advanced log parsing and filtering capabilities
- **Network Communication**: TCP-based communication with the server
- **IP Geolocation Mapping**: Visualize suspicious IP addresses on a map

## ğŸ“ Full Project Structure

```
SIEMonitor/
â”œâ”€â”€ server/                             
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.cpp                    
â”‚   â”‚   â”œâ”€â”€ network/
â”‚   â”‚   â”‚   â”œâ”€â”€ ServerSyslog.h          
â”‚   â”‚   â”‚   â”œâ”€â”€ ServerClient.h         
â”‚   â”‚   â”‚   â”œâ”€â”€ syslog_connections/
â”‚   â”‚   â”‚   |   â”œâ”€â”€ Authentication/
â”‚   â”‚   â”‚   |   |   â”œâ”€â”€AuthService.h
â”‚   â”‚   â”‚   |   |   â””â”€â”€BCript.h
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SyslogListener.h    
â”‚   â”‚   â”‚   â””â”€â”€ clients_connections/
â”‚   â”‚   â”‚       â””â”€â”€ ClientListener.h    
â”‚   â”‚   â”œâ”€â”€ command_handler/
â”‚   â”‚   â”‚   â”œâ”€â”€â”€ CommandHandler.h
â”‚   â”‚   â”‚   â””â”€â”€ commands/
â”‚   â”‚   â”‚       â”œâ”€â”€ ListHosts.hpp
â”‚   â”‚   â”‚       â”œâ”€â”€ OnlineUsers.hpp
â”‚   â”‚   â”‚       â”œâ”€â”€ UpdateData.hpp
â”‚   â”‚   â”‚       â””â”€â”€ LogsData.hpp        
â”‚   â”‚   â”œâ”€â”€ log_parser/
â”‚   â”‚   |   â”œâ”€â”€ GetIpLocation.hpp   
â”‚   â”‚   â”‚   â””â”€â”€ LogDatabaseWriter.h     
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â”œâ”€â”€ ThreadSafeQueue.h       
â”‚   â”‚       â”œâ”€â”€ ProtocolHandler.h 
â”‚   â”‚       â”œâ”€â”€ SplitText.h       
â”‚   â”‚       â””â”€â”€ DBComandExecutor.h      
â”‚   â”œâ”€â”€ makefile                       
â”‚   â””â”€â”€ target/                 
â”œâ”€â”€ client/ 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.cpp 
â”‚   â”‚   â”œâ”€â”€ frontend/
â”‚   â”‚   â”‚   â”œâ”€â”€ gui.h   
â”‚   â”‚   â”‚   â”œâ”€â”€ gui.cpp            
â”‚   â”‚   â”‚   â””â”€â”€ window/
â”‚   â”‚   â”‚       â”œâ”€â”€ home_screen/
â”‚   â”‚   â”‚       â”œâ”€â”€ incidents_screen/
â”‚   â”‚   â”‚       â”œâ”€â”€ analytics_screen/
â”‚   â”‚   â”‚       â”œâ”€â”€ search_screen/          #Not implemented yet
â”‚   â”‚   â”‚       â”œâ”€â”€ threat_screen/          #Not implemented yet
â”‚   â”‚   â”‚       â”œâ”€â”€ siem.h            
â”‚   â”‚   â”‚       â”œâ”€â”€ login.hpp      
â”‚   â”‚   â”‚       â”œâ”€â”€ siem.h           
â”‚   â”‚   â”‚       â””â”€â”€ ip_connect.hpp     
â”‚   â”‚   â””â”€â”€ backend/
â”‚   â”‚       â”œâ”€â”€ ServerConnection.h    
â”‚   â”‚       â”œâ”€â”€ UpdateWorker.h         
â”‚   â”‚       â”œâ”€â”€ SplitLogs.hpp          
â”‚   â”‚       â”œâ”€â”€ SplitLogs.cpp         
â”‚   â”‚       â””â”€â”€ Utils.hpp              
â”‚   â””â”€â”€ makefile                       
â”œâ”€â”€ LICENSE                   

```
## Preview

![img1](imgs/home_screen.png)
![img2](imgs/incidents_screen.png)
![img3](imgs/map_screen.png)

## âœ¨ Key Features

### Real-time Log Processing
- **Syslog Protocol Support**: Standard RFC3164 syslog message reception
- **Multi-threaded Processing**: 4 worker threads for concurrent log writing
- **Thread-safe Queue**: Efficient message queuing between components
- **SQLite3 Storage**: Persistent log storage with optimized queries

### Advanced Log Analysis
- **Severity-based Filtering**: Filter logs by severity levels
- **Host and Source Tracking**: Monitor specific hosts and log sources
- **Search Capabilities**: Full-text search across log messages
- **Resolution Tracking**: Mark and track resolved security incidents

### Modern GUI Interface
- **Multi-window Design**: Separate windows for connection, login, and monitoring
- **Real-time Updates**: Live log streaming with automatic refresh
- **Stacked Widget Layout**: Smooth transitions between different views
- **Responsive Design**: Maximized dashboard for comprehensive monitoring

### Network Architecture
- **TCP Communication**: Reliable client-server communication
- **Protocol Handling**: Custom protocol 
- **Background Processing**: Non-blocking UI with worker threads

## ğŸ”§ Prerequisites

### Server Dependencies
```bash
    git clone https://github.com/rg3/bcrypt
    sudo apt install sqlite3 libsqlite3-dev
    sudo apt-get install libmaxminddb-dev
```

### Client Dependencies
```bash
    moc- sudo apt install qt6-base-dev
    sudo apt-get install qt6-base-dev
```

### Build Requirements
- **C++20 Compiler**: GCC with C++20 support
- **Make**: Build system
- **SQLite3**: Database engine
- **MaxMinddb**: GeoLite2-City.mmdb
- **Qt6**: GUI framework
- **bcrypt**: Password hashing library



## ğŸ“– Usage

### Starting the Server
```bash
cd server
./target/program
```
The server will:
    -Thread Quere
    -Start SyslogListener
    -Start writing log in DataBase
    -Start Syslog server
    -[INFO] Server listen at 1514
    -ClientListenerServer start
    -Server TCP for clients listen at 12345...

### Launching the Client
```bash
cd client
./target/program
```

The client provides:
1. **Server Connection Window**: Configure server IP and port
2. **Login Window**: User authentication
3. **SIEM Dashboard**: Real-time monitoring and log analysis

### Log Data Queries
The system supports various log queries:
- Filter by severity, host, source
- Search log messages
- Track resolved incidents
- Generate statistics and reports
- Map suspicious IP locations on a map 

## ğŸ”’ Security Features

- **Bcrypt Password Hashing**: Secure user authentication
- **Thread-safe Operations**: Concurrent access protection

## ğŸ“Š Performance

- **Multi-threaded Processing**: Concurrent log writing with 4 worker threads
- **Efficient Queuing**: Thread-safe queue for high-throughput processing
- **Optimized Database**: SQLite3 with indexed queries for fast retrieval
- **Lightweight Design**: Minimal resource footprint

## ğŸ“ License

This project is licensed under the GNU General Public License v3.0 - see the [LICENSE](LICENSE) file for details.

